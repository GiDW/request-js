!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).RequestJs=t()}(this,function(){"use strict";var b="accept",E="content-type",t=window.navigator.userAgent,I=function(){var e;if(0<(e=t.indexOf("MSIE ")))return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(0<(e=t.indexOf("Trident/")))return e=t.indexOf("rv:"),parseInt(t.substring(e+3,t.indexOf(".",e)),10);return 0}(),x=document.createElement("a");function S(e,n){var r,o,a=0,s=!1,t=!1,u=!1,i=!1,f=j(e)?{url:e}:C(e)&&j(e.url)?e:null;if(f){var c=f,d=c.url;"number"==typeof c.timeout&&0<c.timeout&&(a=setTimeout(function(){s||(i=!0,p&&p.abort(),g({data:"",config:c,status:0,statusText:"",headers:"",requestStatus:S.TIMEOUT}))},c.timeout));var p=new window.XMLHttpRequest;p.onreadystatechange=function(){if(p&&4===p.readyState){r=1223===p.status?204:p.status,o="response"in p?p.response:p.responseText,0===r&&(r=o?200:"file:"===function(e){var t=e;I&&(x.setAttribute("href",t),t=x.href);return x.setAttribute("href",t),{href:x.href,protocol:x.protocol,host:x.host,search:x.search,hash:x.hash,hostname:x.hostname,port:x.port,pathname:x.pathname}}(c.url).protocol?404:0);var t={data:o,config:c,status:r,statusText:p.statusText||"",headers:p.getAllResponseHeaders(),requestStatus:""};if(200<=r&&r<300)if(!0===c.json&&j(o))try{t.data=JSON.parse(o),t.requestStatus=S.COMPLETED,g(null,t)}catch(e){t.requestStatus=S.ERROR,g(t)}else t.requestStatus=S.COMPLETED,g(null,t);else t.requestStatus=i?S.TIMEOUT:S.ERROR,g(t)}};var l=function(e){if(!C(e))return"";for(var t=[],n=Object.keys(e),r=n.length,o=0;o<r;o++){var a=encodeURIComponent(n[o]),s=e[a];"function"!=typeof s&&(Array.isArray(s)?A(t,a,s):t.push(a+"="+encodeURIComponent(q(s))))}return t.join("&")}(c.params);l&&(d+=0<d.indexOf("?")?"&":"?",d+=l);var h=c.method?c.method.toUpperCase():"GET";if(p.open(h,d,!0),C(c.headers))for(var m=Object.keys(c.headers),O=m.length,v=0;v<O;v++){var R=m[v],y=R.toLowerCase(),T=""+c.headers[R];t||y!==b||(t=!0),u||y!==E||(u=!0),void 0!==T&&p.setRequestHeader(R,T)}return t||p.setRequestHeader(b,"application/json, text/plain, */*"),"POST"!==h&&"PUT"!==h&&"PATCH"!==h||u||p.setRequestHeader(E,"application/json;charset=utf-8"),p.send(void 0!==c.data?c.data:null),{abort:function(){p&&p.abort()}}}function g(e,t){s||(s=!0,clearTimeout(a),function(){p&&(p.onreadystatechange=null);p=null}(),"function"==typeof n&&n(e,t))}g(S.ERR_INVALID_CONFIG)}function C(e){return"object"==typeof e&&null!==e}function j(e){return"string"==typeof e&&0<e.length}function q(e){return C(e)?"[object Date]"===Object.prototype.toString.call(e)?e.toISOString():JSON.stringify(e):e}function i(e,t,n){t&&(e[t]=e[t]?e[t]+", "+n:n)}function A(e,t,n){for(var r=n.length,o=0;o<r;o++){var a=n[o];"function"!=typeof a&&e.push(t+"="+encodeURIComponent(q(a)))}}return S.parseHeaders=function(e){var t={};if(j(e))for(var n=(a=e.trim().split("\n")).length,r=0;r<n;r++){var o=(u=a[r]).indexOf(":");i(t,u.substr(0,o).trim().toLowerCase(),u.substr(o+1).trim())}else if(C(e)){var a,s=(a=Object.keys(e)).length;for(r=0;r<s;r++){var u;i(t,(u=a[r]).toLowerCase(),e[u].trim())}}return t},S.ERR_INVALID_CONFIG="Invalid config",S.ERROR="error",S.ABORTED="aborted",S.TIMEOUT="timeout",S.COMPLETED="completed",S});